So. There is basically no clusters with a size over 5 that have a >50% presence in yeast and look like actual hits. I think I'm cooked there. However, the vast majority of our control (oblins and DAG)
land in the range below 5 members per cluster. I honestly have no idea why, but I strongly suspect that the clustering that Rayan did of the AAs at 90% identity did something funky - I gotta talk 
to Artem about it. I think I'm going to shift my analysis to that end of the spectrum, specifically the 3-4 members per cluster range because singletons is gonna be a massive pain in my ass. 

Artem has suggested that I instead use at least 2 hits in yeast as my cutoff, so I'm doing that.


---- File splitting -----------
splitting down my top level files with subsplitter.sh

Not including Filter mode results in a default to a % cutoff, not including filtercutoff results in no cutoff, not including filter species defaults to saccharomyces.

FILTER_MODE=count FILTER_CUTOFF=2 ./Subsplitter.sh Saccharomyces.X3.circles.w.contigs.tsv Saccharomyces.X3.0-3.fa Saccharomyces.X3.3-5.fa Saccharomyces.X3.5.fa
                                                            ^
                                  Future (unfortunate) user, this class of file is what 
                                  you want for this type fo operation. appologies for the 
                                   shitty naming scheme. 
                    

Filtered out 16833 clusters with <=2 saccharomyces hits
Splitting complete. Checking output files...
Small clusters (<3): 0 sequences
Medium clusters (3-5): 121 sequences
Large clusters (>5): 122 sequences

The singletons are cooked LOL


---- Checking files -----
awk '/^>/ {
    if(header && !seq) print "Missing sequence for: " header
    header=$0; seq=""
} 
!/^>/ && NF > 0 {seq=seq $0} 
END {
    if(header && !seq) print "Missing sequence for: " header
}' Saccharomyces.X3.final.fasta

No bad outputs. should be good for bt2

Uploadeded all files to both my BT2 and Diamond instance. 

==== Diamond =====

diamond blastx -d yeastRP.dmnd -q Saccharomyces.X3.5.fa -o Saccharomyces.X3.5.dmnd.hits.m8 -f 6 --evalue 1e-5   --threads 64

Total time = 0.391s
Reported 350 pairwise alignments, 350 HSPs.
75 queries aligned.


=== Diamond.breaker ===

python3 Diamond.breaker.py Saccharomyces.X3.5.dmnd.hits.m8 Saccharomyces.X3.5.fa Saccharomyces.X3.5.dmnd.null.fa

Filtering FASTA file...
Filtering complete:
  Sequences kept: 47
  Sequences removed: 75
  Total processed: 122

==== BT2 ======== 

bowtie2 -p 8 -f -x reference_index -U Saccharomyces.X3.5.dmnd.null.fa -S Saccharomyces.X3.5.BT2.sam
47 reads; of these:
  47 (100.00%) were unpaired; of these:
    25 (53.19%) aligned 0 times
    15 (31.91%) aligned exactly 1 time
    7 (14.89%) aligned >1 times
46.81% overall alignment rate

=== Bowtie.breaker ===

Bowtie.breaker.py Saccharomyces.X3.5.BT2.sam Saccharomyces.X3.5.dmnd.null.fa Saccharomyces.X3.5.double.null.fa
Filtering FASTA file...
Filtering complete:
  Sequences kept: 25
  Sequences removed: 22
  Total processed: 47

25 sequences above 5 remain...

---- INFERNAL --------------
#target name         accession query name           accession mdl mdl from   mdl to seq from   seq to strand trunc pass   gc  bias  score   E-value inc description of target
#------------------- --------- -------------------- --------- --- -------- -------- -------- -------- ------ ----- ---- ---- ----- ------ --------- --- ---------------------
#
# Program:         cmscan
# Version:         1.1.5 (Sep 2023)
# Pipeline mode:   SCAN
# Query file:      Saccharomyces.X3.5.double.null.fa
# Target file:     Marcos.cm
# Option settings: cmscan --tblout Saccharomyces.X3.5.infernal.tbl -E 0.5 --cpu 50 Marcos.cm Saccharomyces.X3.5.double.null.fa 
# Current dir:     /home/ec2-user
# Date:            Wed Oct  1 16:32:28 2025
# [ok]

Screaming, crying, thowing up. Let's look for rods, DAGs and oblins I guess

---- DAGs / OBs -----

Nada for DAGs. literally 0. 

same for oblins. rip. 


---- RNA fold  ----
./rnafold.sh under.3.ribozyme.hits.fa /home/ec2-user/under.3.rnafold.results

=== Viewing outputs ===

Navigate to target FOLDER and: 


for f in *.ps; do
    gs -dSAFER -dBATCH -dNOPAUSE \
       -sDEVICE=pngalpha \
       -r300 \
       -dEPSCrop \
       -o "${f%.ps}.png" "$f"

    # Add 10px padding after trim
    mogrify -bordercolor none -border 10 "${f%.ps}.png"
done

a couple of clusters look interesting here based on their structures (rods, large cluster sizes). 

Extraction of cluster SRRs:

awk -F'\t' -v OFS='\t' -v cluster=1420298 'BEGIN {print "Accession"} $2 == cluster {split($9, arr, "_"); print arr[1] "_" arr[2]}' Saccharomyces.X3.circles.w.contigs.tsv > 1420298.contigs.tsv

Then drop em into a tsv and hit em with one of these:

./SRA.wrapper.sh 22260.contigs.tsv

Literally nothing interesting LOL

